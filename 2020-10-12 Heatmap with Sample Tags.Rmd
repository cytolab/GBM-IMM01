---
title: "Heatmap3 for RMSD"
author: "Sierra Barone"
date: "10/09/2020"
output: pdf_document
editor_options: 
  chunk_output_type: inline
---

## Heatmap3 for RMSD

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# uncomment lines below to install packages
# install.packages("heatmap3", repos = "http://cran.us.r-project.org")
# install.packages("dplyr", repos = "http://cran.us.r-project.org")
# install.packages("tidyverse", repos = "http://cran.us.r-project.org")

# load packages into the working library
library(heatmap3)
library(dplyr)
library(tidyverse)

# set working directory and read file
setwd(paste(getwd(), sep = ""))
file <- dir(pattern = "*.csv")
RMSD<-read.csv(file, header= T)

# update format
ColSideColors <- cbind(as.character(RMSD$Citrus.ID),as.character(RMSD$Contact.ID),as.character(RMSD$Immune.ID))
colnames(ColSideColors)<- c("citrus","contact","immune")
cluster_num = str_remove(colnames(RMSD),"X")
colnames(RMSD)<-paste0("FlowSOM Cluster No.",cluster_num)
row_cluster = RMSD[,4]
rownames(RMSD)<-paste("FlowSOM Cluster No.",row_cluster)
RMSD.new = RMSD[-c(1:4)]

# scale ranges
scale_min = min(RMSD.new)
scale_max = max(RMSD.new)
scale_range = 100-scale_min

# plot heatmap
heatmap3(RMSD.new,ColSideColors=ColSideColors, RowSideColors = ColSideColors, Rowv=NA, Colv=NA,showRowDendro=TRUE,
         col=colorRampPalette(c( "blue", "green", "yellow", "red"))(4096), scale = "none", symm = F, revC=T)

# to save heatmap to PDF 
pdf(paste(strftime(Sys.time(),"%Y-%m-%d_%H%M%S")," RMSD heatmap.pdf"),width=10)
heatmap3(RMSD.new,ColSideColors=ColSideColors, RowSideColors = ColSideColors, Rowv=NA, Colv=NA,showRowDendro=TRUE,
         col=colorRampPalette(c( "blue", "green", "yellow", "red"))(4096), scale = "none", symm = F, revC=T)
dev.off()

pdf(paste(strftime(Sys.time(),"%Y-%m-%d_%H%M%S")," RMSD heatmap with dendrogram.pdf"),width=10)
heatmap3(RMSD.new,ColSideColors=ColSideColors, RowSideColors = ColSideColors, showRowDendro=TRUE,
         col=colorRampPalette(c( "blue", "green", "yellow", "red"))(4096), scale = "none", symm = F, revC=T)
dev.off()

```
